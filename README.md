# Материалы к Хихи-хаха-тону

## Установка

Если вы не используете conda, то вам придется. Перед непосредственным созданием среды вам нужно залезть в файл environment.yml и отредактировать в нем следующие строчки:

```
- cudatoolkit=11.6 -> cudatoolkit=??
- -f https://data.pyg.org/whl/torch-1.12.0+cu116.html -> -f ???
```

Строчки редактриуется в соотвествии с подходящей для вас версии куды. Конкретные значения для подстановки можно узнать на сайтах [Pytorch](https://pytorch.org/) и [PyG](https://pytorch-geometric.readthedocs.io/en/latest/notes/installation.html). выбрав подходящие вам опции.

Как узнать свою версию cuda?

С помощью вот этой команды (информация в шапке таблицы):

```
nvidia-smi
```

## Общая постановка задачи

Участникам хакатона предстоит спрогнозировать склонность пользователя VK к благотворительной деятельности.

Кейс представляет собой задачу бинарной классификации. Командам будет необходимо изучить последовательность пользовательских состояний, набор вещественных признаков и топ близких ему пользователей с тем же признаковым описанием.

Решение кейса представляет собой модель, которая определяет, интересуется ли пользователь благотворительностью. При оценке будет учитываться не только объективное качество модели, но и обоснование решения. Также обязательным пунктом является обучения модели на графах и извлечение признаков из них.

## Четкая постановка

//

## ХочуВсеЗнать

### Обязательно прочитать

- [Графовые нейронные сети](https://alexanderdyakonov.wordpress.com/2021/12/30/gnn/)
- [Gentel intro to GNN](https://distill.pub/2021/gnn-intro/) и [Understanding Convolutions on Graphs](https://distill.pub/2021/understanding-gnns/)
- [How to get started with ML on graphs](https://medium.com/octavian-ai/how-to-get-started-with-machine-learning-on-graphs-7f0795c83763) - классная небольшая вводная статья без сложной математики

### Getting Deeper

//

## Библиотеки, инструменты

1. [PyG (PyTorch Geometric)](https://pytorch-geometric.readthedocs.io/en/latest/) - основной фреймворк для обучения на графах
2. [NetworkX](https://networkx.org/) - библиотека для визуализации графов
3. [TorchMetrics](https://torchmetrics.readthedocs.io/en/latest/) - удобная библиотека с кучей реализаций стандартных метрик

## Что мы вообще будем делать

Краткое изложение ориентировочного плана действий

1. Загрузка и предобработка данных - здесь могут возникуть любые форматы и данные любой степени грязности (а могут и не возникнуть).
   - Как работать с пропусками в данных?
   - Как превратить .csv/.json/.xyz в объект Dataset?
2. Анализ данных, выдвижение гипотез, еще предобработка - здесь важно сделать правильные предположения относительно применимых методов решения
3. Построение модели и пайплайна обучения - тривиальная часть, но нужно много кода.
4. Обучение => Тюнинг => Обучение => Тюнинг... - долго, нудно, борьба за +1e-5 в качестве, возможно круто будет применить что-то вроде [GraphGym](https://pytorch-geometric.readthedocs.io/en/latest/notes/graphgym.html#) (а может это и слишком)
5. Упаковка модели и анализ (Explainatory AI, [см. пункт про анализ](#анализ-результатов))
6. Презентация - просто рассказать краткую историю решения + анализ результатов

## Датасеты для тренировки

//

## Предобработка данных

//

## Анализ результатов

source: [Explainability in Graph Neural Networks: An Experimental Survey](https://arxiv.org/pdf/2203.09258.pdf)

### TL;DR

Кроме того, что обученная модель будет выдавать какие-то предсказания, которые можно будет качественно оценить с помощью целевой метрики, важным пунктом является объяснение и интерпретация результатов работы модели.

Вообще есть целая область, называемая Exaplainable AI, главной задачей которой является извлечение скрытой информации из моделей, анализ принципов ее работы и "мышления". Это важно, т.к. в сыром виде модели глубокого обучения представляют собой черные ящики, волшебным образом выдающие результат.

Для GNN применимо несколько методов - одни заимствованы из других областей, другие разработны специально для графов.

## Факультативное чтиво

Очень много и подробно. Не для всех, но потенциально нужно.

1. [Курс от Standford про GNN](http://web.stanford.edu/class/cs224w/)
2. [Network Science - книга про графы/сети и их применение](http://networksciencebook.com/) - здесь нет ничего про графовые модели обучения, но много чего просто интересного про графы, короче знание предметной области
